import{r as u,j as e,L as Y,S as Z}from"./app-DX8cLGgb.js";import{B as T}from"./button-C7KDFIMd.js";import{C as ee}from"./checkbox-DGgxRwox.js";import{C as ae,a as se,b as re,c as te,d as oe,e as ie}from"./command-B-oScicF.js";import{u as ne,F as le,a as d,b as m,c,d as x,e as h,f as v}from"./form-C1trlybA.js";import{I as g}from"./input-DQDx2A6B.js";import{L as me}from"./label--Ehrth1z.js";import{P as ce,a as pe,b as de}from"./popover-CRkE7CX6.js";import{R as he,a as y}from"./radio-group-sIwdGPYh.js";import{S as ue}from"./switch-Cr_xz01F.js";import{T as xe}from"./textarea-cs6YctHi.js";import{A as ge}from"./admin-layout-CW32mJlb.js";import{c as D,r as L,p as A}from"./utils-DKeLNgJc.js";import{s as je,o as fe,c as ke,e as be,n as U,a as ve,b as j}from"./types-CnZ1Bj50.js";import{E as ye}from"./Editor-CcQrCHki.js";import{t as C}from"./index-uhjQ-Vgg.js";import Ce from"./course-modules-section-Bsk7PKaS.js";import{B as Ne}from"./book-marked-C-ktJDyl.js";import{C as Pe}from"./chevrons-up-down-BvH19UOJ.js";import{C as Se}from"./check-TlUJ-vzM.js";/* empty css            */import"./index-BU5naBvk.js";import"./index-DLRg5plQ.js";import"./index-BBpcguvp.js";import"./index-CtUr5gy0.js";import"./index-Vk6Q-U5U.js";import"./index-Bh825HqO.js";import"./floating-ui.react-dom-DWGqvIsB.js";import"./index-DvhBUZPr.js";import"./index-DYyonc-E.js";import"./index-BA0bzE_s.js";import"./Combination-DLoqcFOv.js";import"./dialog-CUPUqlBz.js";import"./x-C-3r8rKe.js";import"./createLucideIcon-C--If6eW.js";import"./search-BCfcxY6f.js";import"./dropdown-menu-CauSD08y.js";import"./index-BJXHGMLF.js";import"./sonner-DwWQu8tA.js";import"./breadcrumbs-BUFzNfdR.js";import"./tooltip-C5in7EJF.js";import"./index-Dqm5246v.js";import"./avatar-BtPFzog4.js";import"./use-initials-Cna_5cdi.js";import"./user-BfASVqyB.js";import"./chevron-right-Xt8EQkHh.js";import"./app-sidebar-header-C8CeR_Um.js";import"./user-check-B7TZ-bAV.js";import"./users-CEBcO6a9.js";import"./monitor-play-Bgy6FINu.js";import"./presentation-CXntxea8.js";import"./gift-BjBWPFJu.js";import"./banknote-BEMXCczG.js";import"./dollar-sign-Dgv6g8UB.js";import"./file-text-BAcqPH31.js";import"./index-CXvPuMnT.js";import"./delete-dialog-C-vvx1N0.js";import"./alert-dialog-0twUOfQj.js";import"./badge-De33UR5A.js";import"./separator-BLyiQwVc.js";import"./create-lesson-h7515sTm.js";import"./input-error-BYOm7pFu.js";import"./select-CwNSfF_A.js";import"./chevron-down-C6aBWDuR.js";import"./chevron-up-kAq5eOUm.js";import"./create-module-BIAuNB9_.js";import"./edit-lesson-LFcbUEpb.js";import"./edit-module-BqxdVxM4.js";import"./plus-Cm_SB78M.js";import"./square-pen-BDPemHnf.js";import"./trash-CKsjZP30.js";import"./badge-check-dt-U4U-r.js";import"./lock-BjvZLeRi.js";import"./circle-plus-q_EMPIza.js";const _e=fe({title:j().nonempty("Judul harus diisi"),category_id:j().nonempty("Kategori harus dipilih"),short_description:j().max(200).nullable(),description:j().max(1e3).nullable(),key_points:j().nullable(),thumbnail:ve().nullable(),strikethrough_price:U().min(0),price:U().min(0),level:be(["beginner","intermediate","advanced"]),tools:ke(j()).optional()}).refine(i=>i.strikethrough_price>0?i.strikethrough_price>i.price:!0,{message:"Harga coret harus lebih besar dari harga normal.",path:["strikethrough_price"]});function Wa({course:i,categories:N,tools:B}){var E,F,M;(E=i.modules)==null||E.forEach((a,s)=>{var t;console.log(`Backend Module ${s}:`,a.title,"ID:",a.id),(t=a.lessons)==null||t.forEach((r,o)=>{console.log(`  Backend Lesson ${o}:`,r.title,"ID:",r.id)})});const[K,P]=u.useState(!1),[S,R]=u.useState(i.strikethrough_price>0),[$,_]=u.useState(i.thumbnail?`/storage/${i.thumbnail}`:null),[G,O]=u.useState([]),[w,z]=u.useState(((F=i.images)==null?void 0:F.map(a=>`/storage/${a.image_url}`))||[]),[k,H]=u.useState(((M=i.modules)==null?void 0:M.map(a=>{var t;return{...a,lessons:(t=a.lessons)==null?void 0:t.map(r=>({...r,is_free:r.is_free??!1}))}}))||[]),[J,b]=u.useState(!1),[V,W]=u.useState(!1),q=[{title:"Kelas Online",href:route("courses.index")},{title:i.title,href:route("courses.show",{course:i.id})},{title:"Edit Course",href:route("courses.edit",{course:i.id})}],l=ne({resolver:je(_e),defaultValues:{title:i.title||"",category_id:String(i.category_id)||"",short_description:i.short_description||"",description:i.description||"",key_points:i.key_points||"",thumbnail:"",strikethrough_price:i.strikethrough_price||0,price:i.price||0,level:i.level||"beginner",tools:i.tools?i.tools.map(a=>a.id):[]}});function Q(a){const s=new FormData;k.forEach((r,o)=>{var n;console.log(`Module ${o}:`,r.title,"ID:",r.id),(n=r.lessons)==null||n.forEach((p,f)=>{console.log(`  Lesson ${f}:`,p.title,"ID:",p.id)})}),Object.entries(a).forEach(([r,o])=>{r==="thumbnail"&&o?s.append("thumbnail",o):r==="tools"&&Array.isArray(o)?o.forEach(n=>s.append("tools[]",n)):r!=="thumbnail"&&r!=="sneak_peek_images"&&r!=="tools"&&s.append(r,o)}),G.forEach((r,o)=>{s.append(`sneak_peek_images[${o}]`,r)}),k.forEach((r,o)=>{var n;(n=r.lessons)==null||n.forEach((p,f)=>{p.type==="file"&&p.attachment instanceof File&&s.append(`modules[${o}][lessons][${f}][attachment]`,p.attachment)})});const t=k.map(r=>{var o;return{...r,lessons:(o=r.lessons)==null?void 0:o.map(n=>({...n,...n.type==="file"&&!(n.attachment instanceof File)?{attachment:n.attachment}:{}}))}});s.append("modules",JSON.stringify(t)),s.append("_method","PUT"),Z.post(route("courses.update",{course:i.id}),s,{forceFormData:!0})}const X=a=>{const s=Array.from(a.target.files??[]).slice(0,4),t=s.some(o=>o.size>2*1024*1024);if(W(t),t){C("Ukuran setiap gambar maksimal 2MB!");return}O(s);const r=s.map(o=>new Promise(n=>{const p=new FileReader;p.onload=f=>{var I;return n((I=f.target)==null?void 0:I.result)},p.readAsDataURL(o)}));Promise.all(r).then(z)};return e.jsxs(ge,{breadcrumbs:q,children:[e.jsx(Y,{title:"Edit Kelas"}),e.jsxs("div",{className:"px-4 py-4 md:px-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Edit Kelas"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl text-sm",children:'Ubah data kelas di bawah ini. Setelah selesai, klik tombol "Simpan Perubahan".'}),e.jsxs("div",{className:"grid grid-cols-1 items-start gap-6 lg:grid-cols-2",children:[e.jsx(le,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(Q),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{size:16}),e.jsx("h3",{className:"font-medium",children:"Detail Informasi Kelas"})]}),e.jsx(d,{control:l.control,name:"title",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Judul Kelas"}),e.jsx(x,{children:e.jsx(g,{placeholder:"Masukkan judul kelas",...a,autoComplete:"off"})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"category_id",render:({field:a})=>{var s;return e.jsxs(m,{className:"flex flex-col",children:[e.jsx(c,{children:"Kategori"}),e.jsxs(ce,{open:K,onOpenChange:P,children:[e.jsx(pe,{asChild:!0,children:e.jsx(x,{children:e.jsxs(T,{variant:"outline",role:"combobox",className:D("justify-between",!a.value&&"text-muted-foreground"),children:[a.value?(s=N.find(t=>t.id===a.value))==null?void 0:s.name:"Pilih kategori",e.jsx("span",{className:"sr-only",children:"Pilih kategori"}),e.jsx(Pe,{className:"opacity-50"})]})})}),e.jsx(de,{className:"p-0",children:e.jsxs(ae,{children:[e.jsx(se,{placeholder:"Cari kategori...",className:"h-9"}),e.jsxs(re,{children:[e.jsx(te,{children:"Tidak ada kategori ditemukan."}),e.jsx(oe,{children:N.map(t=>e.jsxs(ie,{value:t.name,onSelect:()=>{l.setValue("category_id",t.id),P(!1)},children:[t.name,e.jsx(Se,{className:D("ml-auto",t.id===a.value?"opacity-100":"opacity-0")})]},t.id))})]})]})})]}),e.jsx(h,{})]})}}),e.jsx(d,{control:l.control,name:"tools",render:()=>e.jsxs(m,{children:[e.jsx(c,{children:"Tools yang Digunakan"}),e.jsx("div",{className:"text-muted-foreground mb-2 text-sm",children:"Pilih tools yang digunakan pada bootcamp ini."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:B.map(a=>e.jsx(d,{control:l.control,name:"tools",render:({field:s})=>{var t;return e.jsxs(m,{className:"flex flex-row items-center gap-2 space-y-0",children:[e.jsx(x,{children:e.jsx(ee,{checked:(t=s.value)==null?void 0:t.includes(a.id),onCheckedChange:r=>{var o;r?s.onChange([...s.value??[],a.id]):s.onChange((o=s.value)==null?void 0:o.filter(n=>n!==a.id))}})}),e.jsx(c,{className:"text-sm font-normal",children:a.name})]})}},a.id))}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"short_description",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Deskripsi Singkat"}),e.jsx(x,{children:e.jsx(g,{placeholder:"Masukkan deskripsi singkat",...a,value:a.value??"",autoComplete:"off"})}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"description",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Deskripsi Lengkap"}),e.jsx(xe,{...a,value:a.value??"",className:"w-full rounded border p-2",placeholder:"Masukkan deskripsi lengkap",autoComplete:"off"}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"key_points",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Materi (Poin Utama)"}),e.jsx(ye,{apiKey:"9fm93mwrg1xyj51jh2isx0m0t3irr4sjgk2ief9b4bdpgpa1",value:a.value??"",onEditorChange:s=>a.onChange(s),init:{plugins:["anchor","autolink","charmap","codesample","emoticons","image","link","lists","media","searchreplace","table","visualblocks","wordcount"],onboarding:!1,toolbar:"undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat",tinycomments_mode:"embedded",tinycomments_author:"Author name",mergetags_list:[{value:"First.Name",title:"First Name"},{value:"Email",title:"Email"}],height:300}}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"thumbnail",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Thumbnail (File Upload)"}),e.jsx("img",{src:$||"/assets/images/placeholder.png",alt:"Preview Thumbnail",className:"my-1 mt-2 h-40 w-64 rounded border object-cover"}),e.jsx(g,{type:"file",name:a.name,accept:"image/png, image/jpeg, image/jpg",className:J?"border-red-500 focus-visible:ring-red-500":"",onChange:s=>{var r;const t=((r=s.target.files)==null?void 0:r[0])??null;if(t){if(!["image/png","image/jpeg","image/jpg"].includes(t.type)){b(!0),C("Gambar harus png, jpg, atau jpeg");return}if(t.size>2*1024*1024){b(!0),C("Ukuran file maksimal 2MB!");return}}if(b(!1),a.onChange(t),t){const o=new FileReader;o.onload=n=>{var p;return _((p=n.target)==null?void 0:p.result)},o.readAsDataURL(t)}else _(null)}}),e.jsx(v,{className:"ms-1",children:"Upload Icon. Format: PNG atau JPG Max 2 Mb"}),e.jsx(h,{})]})}),e.jsxs(m,{children:[e.jsx(c,{children:"Sneak Peek Kelas (Maksimal 4 gambar)"}),w.length>0&&e.jsx("div",{className:"mb-2 flex flex-wrap gap-2",children:w.map((a,s)=>e.jsx("img",{src:a,alt:`Sneak Peek ${s+1}`,className:"h-24 w-24 rounded border object-cover"},s))}),e.jsx(g,{type:"file",accept:"image/*",multiple:!0,onChange:X,max:4,className:V?"border-red-500 focus-visible:ring-red-500":""}),e.jsx(v,{className:"ms-1",children:"Upload hingga 4 gambar. Format: PNG/JPG, max 2MB per gambar."})]}),e.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{id:"show-strikethrough",checked:S,onCheckedChange:a=>{R(a),a||l.setValue("strikethrough_price",0)}}),e.jsx(me,{htmlFor:"show-strikethrough",children:"Aktifkan Harga Coret (Opsional)"})]}),S&&e.jsx(d,{control:l.control,name:"strikethrough_price",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Harga Coret"}),e.jsx(g,{...a,type:"text",placeholder:"Rp 0",value:L.format(a.value||0),onChange:s=>a.onChange(A(s.target.value)),autoComplete:"off"}),e.jsx(v,{children:"Harga asli yang akan ditampilkan tercoret."}),e.jsx(h,{})]})})]}),e.jsx(d,{control:l.control,name:"price",render:({field:a})=>e.jsxs(m,{children:[e.jsx(c,{children:"Harga"}),e.jsx(g,{...a,type:"text",placeholder:"Masukkan harga kursus",value:L.format(a.value||0),onChange:s=>a.onChange(A(s.target.value)),autoComplete:"off"}),e.jsx(h,{})]})}),e.jsx(d,{control:l.control,name:"level",render:({field:a})=>e.jsxs(m,{className:"space-y-3",children:[e.jsx(c,{children:"Tingkat Kesulitan"}),e.jsx(x,{children:e.jsxs(he,{onValueChange:a.onChange,defaultValue:a.value,className:"flex flex-col",children:[e.jsxs(m,{className:"flex items-center gap-3",children:[e.jsx(x,{children:e.jsx(y,{value:"beginner"})}),e.jsx(c,{className:"font-normal",children:"Beginner"})]}),e.jsxs(m,{className:"flex items-center gap-3",children:[e.jsx(x,{children:e.jsx(y,{value:"intermediate"})}),e.jsx(c,{className:"font-normal",children:"Intermediate"})]}),e.jsxs(m,{className:"flex items-center gap-3",children:[e.jsx(x,{children:e.jsx(y,{value:"advanced"})}),e.jsx(c,{className:"font-normal",children:"Advanced"})]})]})}),e.jsx(h,{})]})})]}),e.jsx(T,{type:"submit",className:"w-full hover:cursor-pointer",children:"Simpan Perubahan"})]})}),e.jsx(Ce,{modules:k,setModules:H,lessons:[],setLessons:()=>{}})]})]})]})}export{Wa as default};
